# Telegram æœºå™¨äººè®¢é˜…é“¾æ¥æ˜¾ç¤ºä¿®å¤

## é—®é¢˜
æ‚¨åœ¨ `config.json` ä¸­é…ç½®äº†è®¢é˜…é“¾æ¥ï¼Œä½† Telegram æœºå™¨äººçš„ `/admin sources list` å’Œ `/changem3u` å‘½ä»¤æ˜¾ç¤º"æœªè®¾ç½®"ã€‚

## å·²ä¿®å¤ âœ…

### ä¿®å¤å†…å®¹
- âœ… `/admin sources list` ç°åœ¨èƒ½æ­£ç¡®æ˜¾ç¤ºæ‚¨åœ¨ config.json ä¸­é…ç½®çš„è®¢é˜…é“¾æ¥
- âœ… `/changem3u` ç°åœ¨èƒ½æ­£ç¡®æ˜¾ç¤ºå½“å‰çš„è®¢é˜…é“¾æ¥
- âœ… å®Œå…¨å‘åå…¼å®¹æ—§æ ¼å¼é…ç½®ï¼ˆ`originalServer.url`ï¼‰
- âœ… åŒæ—¶æ”¯æŒæ–°æ ¼å¼é…ç½®ï¼ˆ`originalServer.urls`ï¼‰

### å¦‚ä½•éªŒè¯ä¿®å¤

1. **è¿è¡Œæµ‹è¯•è„šæœ¬**ï¼š
   ```bash
   node test/test_old_format_config.js
   ```

2. **é‡å¯æœåŠ¡å™¨**ï¼š
   ```bash
   npm start
   ```

3. **åœ¨ Telegram ä¸­æµ‹è¯•**ï¼š
   ```
   /admin sources list
   ```
   æˆ–
   ```
   /changem3u
   ```

### é¢„æœŸç»“æœ

ç°åœ¨æ‚¨åº”è¯¥èƒ½çœ‹åˆ°ï¼š

#### `/admin sources list` æ˜¾ç¤ºï¼š
```
ğŸ“º è®¢é˜…æºåˆ—è¡¨ (1 ä¸ª)

1. âœ… é»˜è®¤è®¢é˜…æº
   ğŸ“¡ URL: https://judy.diver.eu.org/m3u/judy_neibu.m3u
   ğŸ“Š é¢‘é“: 3363 ä¸ª
   ğŸ“‚ åˆ†ç±»: XX ä¸ª
   ğŸ”„ æ›´æ–°: 2025-12-07 10:50:00

ğŸ“Š æ€»è®¡ï¼š
â€¢ æ€»é¢‘é“æ•°ï¼š3363
â€¢ æ€»åˆ†ç±»æ•°ï¼šXX
```

#### `/changem3u` æ˜¾ç¤ºï¼š
```
ğŸ“º å½“å‰M3Uè®¢é˜…é“¾æ¥ç®¡ç†ï¼š

ğŸ”— å½“å‰é“¾æ¥ï¼š
https://judy.diver.eu.org/m3u/judy_neibu.m3u

ğŸ“Š å½“å‰çŠ¶æ€ï¼š
â€¢ é¢‘é“æ•°é‡ï¼š3363
â€¢ é“¾æ¥çŠ¶æ€ï¼šâœ… å·²é…ç½®
```

## æ— éœ€ä¿®æ”¹é…ç½®æ–‡ä»¶

æ‚¨çš„ `config.json` é…ç½®å®Œå…¨æ­£ç¡®ï¼Œæ— éœ€ä»»ä½•ä¿®æ”¹ï¼

```json
{
  "originalServer": {
    "url": "https://judy.diver.eu.org/m3u/judy_neibu.m3u",
    "m3uPath": "",
    "timeout": 10000,
    "autoRefreshInterval": 7200000,
    "enableAutoRefresh": true
  }
}
```

è¿™ç§æ—§æ ¼å¼é…ç½®ä¼šè¢«è‡ªåŠ¨è¯†åˆ«å¹¶æ­£ç¡®æ˜¾ç¤ºã€‚

## æ·»åŠ æ›´å¤šè®¢é˜…æºï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨æƒ³æ·»åŠ æ›´å¤šè®¢é˜…æºï¼Œå¯ä»¥ä½¿ç”¨ Telegram å‘½ä»¤ï¼š

```
/admin sources add https://another-provider.com/playlist.m3u ç¬¬äºŒä¸ªæº
```

ç³»ç»Ÿä¼šè‡ªåŠ¨ï¼š
1. åˆ›å»º `urls` æ•°ç»„
2. ä¿ç•™æ‚¨ç°æœ‰çš„è®¢é˜…é“¾æ¥
3. æ·»åŠ æ–°çš„è®¢é˜…æº
4. è‡ªåŠ¨åˆ·æ–°é¢‘é“åˆ—è¡¨

## æŠ€æœ¯ç»†èŠ‚

ä¿®å¤äº† `src/managers/telegram/AdminHandler.js` ä¸­çš„ä¸¤ä¸ªæ–¹æ³•ï¼š
- `listSources()` - ç°åœ¨èƒ½è¯†åˆ«æ—§æ ¼å¼çš„ `url` å­—æ®µ
- `handleChangeM3U()` - ç°åœ¨èƒ½æ­£ç¡®æ˜¾ç¤ºå½“å‰é“¾æ¥

è¯¦ç»†æ–‡æ¡£ï¼š[OLD_FORMAT_COMPATIBILITY_FIX.md](OLD_FORMAT_COMPATIBILITY_FIX.md)

## é—®é¢˜åé¦ˆ

å¦‚æœä¿®å¤åä»æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. è¿è¡Œæµ‹è¯•è„šæœ¬æŸ¥çœ‹è¾“å‡º
2. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—
3. æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯

---

**ä¿®å¤æ—¥æœŸ**ï¼š2025å¹´12æœˆ7æ—¥  
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆå¹¶æµ‹è¯•

