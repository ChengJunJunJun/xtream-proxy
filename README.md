# Xtream Codes Proxy

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„IPTVä»£ç†æœåŠ¡å™¨ï¼Œé›†æˆTelegramæœºå™¨äººç®¡ç†ï¼Œæä¾›å®‰å…¨çš„IPTVè®¿é—®æ§åˆ¶å’Œç”¨æˆ·ç®¡ç†åŠŸèƒ½ã€‚

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### ğŸ” å®‰å…¨è®¿é—®æ§åˆ¶
- **ç¾¤ç»„æƒé™éªŒè¯**ï¼šåªæœ‰æŒ‡å®šTelegramç¾¤ç»„çš„æˆå‘˜æ‰èƒ½è·å¾—è®¢é˜…é“¾æ¥
- **24å°æ—¶è‡ªåŠ¨è¿‡æœŸ**ï¼šç”Ÿæˆçš„é“¾æ¥åœ¨24å°æ—¶å†…è‡ªåŠ¨å¤±æ•ˆï¼Œæ— éœ€IPéªŒè¯
- **è‡ªåŠ¨è¿‡æœŸæé†’**ï¼šæœºå™¨äººä¼šåœ¨é“¾æ¥è¿‡æœŸå‰è‡ªåŠ¨æ¨é€æé†’æ¶ˆæ¯
- **ä»¤ç‰ŒéªŒè¯ç³»ç»Ÿ**ï¼šé€šè¿‡ä¸´æ—¶ä»¤ç‰ŒéªŒè¯ç”¨æˆ·èº«ä»½
- **User-Agent éªŒè¯**ï¼šæ”¯æŒä¸ºä¸åŒæœåŠ¡å™¨è®¾ç½®ç‰¹å®šçš„ User-Agent è¦æ±‚

### ğŸ¤– Telegramæœºå™¨äººé›†æˆ
- **ç§èŠæ“ä½œ**ï¼šæ‰€æœ‰æ•æ„Ÿæ“ä½œéƒ½åœ¨ç§èŠä¸­è¿›è¡Œï¼Œä¿æŠ¤ç”¨æˆ·éšç§
- **ç¾¤ç»„æˆå‘˜ç›‘æ§**ï¼šè‡ªåŠ¨ç›‘æ§ç¾¤ç»„æˆå‘˜å˜åŒ–ï¼Œç¦»å¼€ç¾¤ç»„è‡ªåŠ¨æ’¤é”€æƒé™
- **ç®¡ç†å‘˜åŠŸèƒ½**ï¼šå®Œæ•´çš„ç®¡ç†å‘˜é¢æ¿å’Œæƒé™ç®¡ç†
- **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä¸­æ–‡ç•Œé¢

### ğŸ“º IPTVåŠŸèƒ½
- **M3Uæ’­æ”¾åˆ—è¡¨**ï¼šæ”¯æŒæ ‡å‡†M3Uå’ŒM3U Plusæ ¼å¼
- **KODIPROP æ”¯æŒ**ï¼šå®Œæ•´æ”¯æŒ KODIPROP å’Œ EXTVLCOPT æŒ‡ä»¤ï¼Œå…¼å®¹ DRM å†…å®¹
- **å¤šè®¢é˜…æºæ”¯æŒ**ï¼šæ”¯æŒåŒæ—¶é…ç½®å¤šä¸ªM3Uè®¢é˜…æºï¼Œè‡ªåŠ¨åˆå¹¶é¢‘é“
- **é¢‘é“ç®¡ç†**ï¼šè‡ªåŠ¨è·å–å’Œç®¡ç†IPTVé¢‘é“
- **å¹¶å‘æ§åˆ¶**ï¼šé™åˆ¶ç”¨æˆ·åŒæ—¶æ’­æ”¾çš„è®¾å¤‡æ•°é‡
- **æµé‡ç›‘æ§**ï¼šå®æ—¶ç›‘æ§ç”¨æˆ·ä½¿ç”¨æƒ…å†µ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 16.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- npm æˆ– yarn åŒ…ç®¡ç†å™¨

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd xtream-proxy
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **é…ç½®æ–‡ä»¶**
```bash
cp config.json.example config.json
```

4. **ç¼–è¾‘é…ç½®æ–‡ä»¶**
```bash
nano config.json
```

5. **å¯åŠ¨æœåŠ¡**
```bash
npm start
```

## âš™ï¸ é…ç½®è¯´æ˜

### æœåŠ¡å™¨é…ç½® (server)
```json
{
  "server": {
    "port": 8080,                    // æœåŠ¡å™¨ç«¯å£
    "host": "0.0.0.0",              // ç›‘å¬åœ°å€
    "externalUrl": "http://localhost:8080"  // å¤–éƒ¨è®¿é—®URL
  }
}
```

### åŸå§‹æœåŠ¡å™¨é…ç½® (originalServer)

#### å•è®¢é˜…æºé…ç½®ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰
```json
{
  "originalServer": {
    "url": "https://example.com/playlist.m3u",  // M3Uæ’­æ”¾åˆ—è¡¨URL
    "m3uPath": "",                              // M3Uæ–‡ä»¶è·¯å¾„ï¼ˆå¯é€‰ï¼‰
    "timeout": 10000,                           // è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    "autoRefreshInterval": 7200000,             // è‡ªåŠ¨åˆ·æ–°é—´éš”ï¼ˆæ¯«ç§’ï¼‰
    "enableAutoRefresh": true                   // å¯ç”¨è‡ªåŠ¨åˆ·æ–°
  }
}
```

#### å¤šè®¢é˜…æºé…ç½®ï¼ˆæ¨èï¼‰
```json
{
  "originalServer": {
    "url": "https://example.com/playlist.m3u",  // å…¼å®¹å­—æ®µ
    "urls": [                                   // å¤šè®¢é˜…æºé…ç½®
      {
        "url": "https://provider1.com/playlist.m3u",
        "name": "æº1",
        "enabled": true
      },
      {
        "url": "https://provider2.com/playlist.m3u", 
        "name": "æº2",
        "enabled": true
      }
    ],
    "m3uPath": "",
    "timeout": 10000,
    "autoRefreshInterval": 7200000,
    "enableAutoRefresh": true
  }
}
```

**å¤šè®¢é˜…æºè¯´æ˜ï¼š**
- ç³»ç»Ÿä¼šè‡ªåŠ¨ä»æ‰€æœ‰å¯ç”¨çš„è®¢é˜…æºåŠ è½½é¢‘é“å¹¶åˆå¹¶
- æ¯ä¸ªè®¢é˜…æºå¯ä»¥ç‹¬ç«‹å‘½åå’Œå¯ç”¨/ç¦ç”¨
- æ—§çš„å•è®¢é˜…æºé…ç½®ä¼šè‡ªåŠ¨è¿ç§»åˆ°æ–°æ ¼å¼
- ä½¿ç”¨ `/admin sources` å‘½ä»¤ç®¡ç†å¤šä¸ªè®¢é˜…æº

### Telegramæœºå™¨äººé…ç½® (telegram)
```json
{
  "telegram": {
    "botToken": "YOUR_BOT_TOKEN",               // æœºå™¨äººToken
    "groupId": "-1001234567890",                // æˆæƒç¾¤ç»„IDï¼ˆæ”¯æŒå¤šç¾¤ç»„ï¼‰
    "adminUserId": "123456789",                 // ä¸»ç®¡ç†å‘˜ID
    "adminUserIds": ["123456789", "987654321"], // ç®¡ç†å‘˜IDåˆ—è¡¨
    "tokenExpiry": 600000,                      // ä»¤ç‰Œæœ‰æ•ˆæœŸï¼ˆ10åˆ†é’Ÿï¼‰
    "maxTokensPerUser": 2,                      // æ¯ç”¨æˆ·æ¯æ—¥æœ€å¤§ä»¤ç‰Œæ•°
    "tokenGenerationPeriod": 86400000           // ä»¤ç‰Œç”Ÿæˆå‘¨æœŸï¼ˆ24å°æ—¶ï¼‰
  }
}
```

### å®‰å…¨é…ç½® (security)
```json
{
  "security": {
    "connectionTimeout": 60000,      // è¿æ¥è¶…æ—¶æ—¶é—´
    "cleanupInterval": 20000,        // æ¸…ç†é—´éš”
    "enableLogging": true,           // å¯ç”¨æ—¥å¿—è®°å½•
    "allowedIPs": [],               // å…è®¸çš„IPåˆ—è¡¨ï¼ˆç©ºä¸ºå…è®¸æ‰€æœ‰ï¼‰
    "blockedIPs": [],               // é˜»æ­¢çš„IPåˆ—è¡¨
    "enableIPBinding": false,        // å¯ç”¨IPç»‘å®š
    "redirectTokenExpiry": 7200000,  // é‡å®šå‘ä»¤ç‰Œè¿‡æœŸæ—¶é—´
    "maxTokenUsage": 3              // æœ€å¤§ä»¤ç‰Œä½¿ç”¨æ¬¡æ•°
  }
}
```

### æ’­æ”¾åˆ—è¡¨é…ç½® (playlist)
```json
{
  "playlist": {
    "refreshLimitPeriod": 18000000,              // åˆ·æ–°é™åˆ¶å‘¨æœŸ
    "maxRefreshesBeforeExpiry": 6,               // è¿‡æœŸå‰æœ€å¤§åˆ·æ–°æ¬¡æ•°
    "maxSimultaneousPlaylists": 3,               // æœ€å¤§åŒæ—¶æ’­æ”¾åˆ—è¡¨æ•°
    "defaultLinkExpiry": 86400000,               // é»˜è®¤é“¾æ¥è¿‡æœŸæ—¶é—´ï¼ˆ24å°æ—¶ï¼‰
    "enablePersistentStorage": true,             // å¯ç”¨æŒä¹…åŒ–å­˜å‚¨
    "persistentStorageCleanupInterval": 86400000, // å­˜å‚¨æ¸…ç†é—´éš”
    "enablePermanentUsers": false,               // å¯ç”¨æ°¸ä¹…ç”¨æˆ·
    "userLinkExpiry": 86400000,                 // ç”¨æˆ·é“¾æ¥è¿‡æœŸæ—¶é—´ï¼ˆ24å°æ—¶ï¼‰
    "expiryNotificationHours": [24, 12, 1]      // è¿‡æœŸæé†’æ—¶é—´ç‚¹
  }
}
```

### åŠŸèƒ½é…ç½® (features)
```json
{
  "features": {
    "enableAdmin": true,             // å¯ç”¨ç®¡ç†å‘˜åŠŸèƒ½
    "enableStatus": true,            // å¯ç”¨çŠ¶æ€æŸ¥è¯¢
    "enableEPG": true,              // å¯ç”¨ç”µå­èŠ‚ç›®æŒ‡å—
    "cacheChannels": true,          // ç¼“å­˜é¢‘é“ä¿¡æ¯
    "channelRefreshInterval": 3600000, // é¢‘é“åˆ·æ–°é—´éš”
    "enableTelegramBot": true,       // å¯ç”¨Telegramæœºå™¨äºº
    "filterChannels": {
      "enabled": true,               // å¯ç”¨é¢‘é“è¿‡æ»¤
      "blacklistKeywords": [],       // é»‘åå•å…³é”®è¯
      "whitelistKeywords": []        // ç™½åå•å…³é”®è¯
    }
  }
}
```

### User-Agent é…ç½® (userAgent)
```json
{
  "userAgent": {
    "enabled": false,                // å¯ç”¨User-AgentéªŒè¯
    "defaultUserAgent": "judy/8.8.8", // é»˜è®¤User-Agent
    "channels": {},                  // æœåŠ¡å™¨ç‰¹å®šè®¾ç½®ï¼ˆè‡ªåŠ¨ç®¡ç†ï¼‰
    "enforceValidation": true,       // å¼ºåˆ¶æ‰§è¡ŒéªŒè¯
    "fallbackUrl": "https://smart.pendy.dpdns.org/judy/output.m3u8" // å›é€€è§†é¢‘URL
  }
}
```

## ğŸ¤– Telegramæœºå™¨äººä½¿ç”¨

### ç”¨æˆ·å‘½ä»¤

#### åŸºç¡€å‘½ä»¤
- `/start` - å¼€å§‹ä½¿ç”¨æœºå™¨äºº
- `/help` - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
- `/gettoken` - è·å–è®¿é—®ä»¤ç‰Œ
- `/mycredentials` - æŸ¥çœ‹ç™»å½•å‡­æ®

#### è·å–è®¿é—®æƒé™æµç¨‹
1. **åŠ å…¥æˆæƒç¾¤ç»„**ï¼šç¡®ä¿æ‚¨å·²åŠ å…¥æŒ‡å®šçš„Telegramç¾¤ç»„
2. **ç§èŠæœºå™¨äºº**ï¼šç‚¹å‡»æœºå™¨äººå¤´åƒå¼€å§‹ç§èŠ
3. **è·å–ä»¤ç‰Œ**ï¼šä½¿ç”¨ `/gettoken` å‘½ä»¤è·å–8ä½è®¿é—®ä»¤ç‰Œ
4. **éªŒè¯ä»¤ç‰Œ**ï¼šåœ¨ç§èŠä¸­ç›´æ¥å‘é€ä»¤ç‰Œè¿›è¡ŒéªŒè¯
5. **è·å¾—å‡­æ®**ï¼šéªŒè¯æˆåŠŸåè‡ªåŠ¨è·å¾—24å°æ—¶æœ‰æ•ˆçš„æ’­æ”¾åˆ—è¡¨é“¾æ¥

### ç®¡ç†å‘˜å‘½ä»¤

#### ç³»ç»Ÿç®¡ç†
- `/admin` - ç®¡ç†å‘˜é¢æ¿
- `/status` - æŸ¥çœ‹æœåŠ¡å™¨çŠ¶æ€
- `/refresh` - åˆ·æ–°é¢‘é“åˆ—è¡¨

#### è®¢é˜…æºç®¡ç†
- `/admin sources list` - æŸ¥çœ‹æ‰€æœ‰è®¢é˜…æºåŠçŠ¶æ€
- `/admin sources add <URL> <åç§°>` - æ·»åŠ æ–°è®¢é˜…æº
- `/admin sources remove <ç´¢å¼•>` - ç§»é™¤è®¢é˜…æº
- `/admin sources enable <ç´¢å¼•>` - å¯ç”¨è®¢é˜…æº
- `/admin sources disable <ç´¢å¼•>` - ç¦ç”¨è®¢é˜…æº
- `/admin sources rename <ç´¢å¼•> <æ–°åç§°>` - é‡å‘½åè®¢é˜…æº
- `/admin sources refresh` - åˆ·æ–°æ‰€æœ‰è®¢é˜…æº

#### æƒé™ç®¡ç†
- `/addadmin <ç”¨æˆ·ID>` - æ·»åŠ ç®¡ç†å‘˜
- `/removeadmin <ç”¨æˆ·ID>` - ç§»é™¤ç®¡ç†å‘˜
- `/listadmins` - æŸ¥çœ‹ç®¡ç†å‘˜åˆ—è¡¨

#### é…ç½®ç®¡ç†
- `/changem3u <æ–°é“¾æ¥>` - ä¿®æ”¹M3Uè®¢é˜…é“¾æ¥ï¼ˆå…¼å®¹æ—§æ–¹å¼ï¼‰
- æ¨èä½¿ç”¨ `/admin sources` å‘½ä»¤ç®¡ç†å¤šä¸ªè®¢é˜…æº

#### User-Agent ç®¡ç†
- `/admin useragent` - User-Agent ç®¡ç†é¢æ¿
- `/admin useragent list` - æŸ¥çœ‹æ‰€æœ‰User-Agentè®¾ç½®
- `/admin useragent set <æœåŠ¡å™¨URL> <User-Agent>` - è®¾ç½®æœåŠ¡å™¨User-Agent
- `/admin useragent remove <æœåŠ¡å™¨URL>` - ç§»é™¤æœåŠ¡å™¨User-Agentè®¾ç½®
- `/admin useragent enable` - å¯ç”¨User-AgentéªŒè¯
- `/admin useragent disable` - ç¦ç”¨User-AgentéªŒè¯
- `/admin useragent default <User-Agent>` - è®¾ç½®é»˜è®¤User-Agent
- `/admin useragent fallback <è§†é¢‘URL>` - è®¾ç½®éªŒè¯å¤±è´¥æ—¶çš„å›é€€è§†é¢‘

## ğŸ”’ æƒé™æ§åˆ¶æœºåˆ¶

### ç¾¤ç»„æƒé™éªŒè¯
- åªæœ‰æŒ‡å®šç¾¤ç»„çš„æˆå‘˜æ‰èƒ½ä½¿ç”¨æœºå™¨äººåŠŸèƒ½
- æ”¯æŒå¤šä¸ªæˆæƒç¾¤ç»„ï¼Œç”¨æˆ·åªéœ€åœ¨å…¶ä¸­ä»»æ„ä¸€ä¸ªç¾¤ç»„å³å¯
- éç¾¤ç»„æˆå‘˜å°è¯•ä½¿ç”¨æ—¶ä¼šæ”¶åˆ°"ä½ æ²¡æœ‰æƒé™è·å¾—é“¾æ¥"çš„æç¤º
- ç¦»å¼€æ‰€æœ‰æˆæƒç¾¤ç»„åè‡ªåŠ¨æ’¤é”€æ‰€æœ‰è®¿é—®æƒé™

#### å¤šç¾¤ç»„é…ç½®æ–¹æ³•
1. **å•ä¸ªç¾¤ç»„**ï¼š`"groupId": "-1001234567890"`
2. **å¤šä¸ªç¾¤ç»„ï¼ˆé€—å·åˆ†éš”ï¼‰**ï¼š`"groupId": "-1002176362246,-1002413589581,-1001912957445"`
3. **å¤šä¸ªç¾¤ç»„ï¼ˆæ•°ç»„æ ¼å¼ï¼‰**ï¼š`"groupId": ["-1002176362246", "-1002413589581", "-1001912957445"]`

#### å¤šç¾¤ç»„ç‰¹æ€§
- è‡ªåŠ¨å»é™¤ç©ºæ ¼ï¼Œè¿‡æ»¤æ— æ•ˆID
- å…¼å®¹åŸæœ‰å•ç¾¤ç»„é…ç½®
- ç”¨æˆ·åœ¨ä»»æ„ç¾¤ç»„éƒ½æœ‰å®Œæ•´æƒé™
- ç®¡ç†å‘˜å¯ä»ä»»æ„ç¾¤ç»„è·å–ç”¨æˆ·ä¿¡æ¯

### 24å°æ—¶è‡ªåŠ¨è¿‡æœŸ
- æ¯æ¬¡éªŒè¯ä»¤ç‰Œåè·å¾—24å°æ—¶è®¿é—®æƒé™
- é“¾æ¥ä¸éœ€è¦IPéªŒè¯ï¼Œå¯åœ¨ä»»ä½•è®¾å¤‡ä¸Šä½¿ç”¨
- è¿‡æœŸåéœ€è¦é‡æ–°è·å–ä»¤ç‰Œæ¥ç»­æœŸ

### è‡ªåŠ¨æé†’ç³»ç»Ÿ
- é“¾æ¥è¿‡æœŸå‰24å°æ—¶è‡ªåŠ¨å‘é€æé†’
- è¿‡æœŸåç«‹å³å‘é€è¿‡æœŸé€šçŸ¥
- æä¾›è¯¦ç»†çš„ç»­æœŸæŒ‡å¯¼

## ğŸ“± æ”¯æŒçš„æ’­æ”¾å™¨

### æ¨èæ’­æ”¾å™¨
- **IPTV Smarters Pro** - åŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒEPG
- **TiviMate** - ç•Œé¢ç¾è§‚ï¼Œæ€§èƒ½ä¼˜ç§€
- **VLC Media Player** - å¼€æºå…è´¹ï¼Œå…¼å®¹æ€§å¥½
- **Perfect Player** - è½»é‡çº§ï¼Œå¯åŠ¨å¿«é€Ÿ
- **GSE Smart IPTV** - åŠŸèƒ½ä¸°å¯Œï¼Œè‡ªå®šä¹‰æ€§å¼º

### æ’­æ”¾åˆ—è¡¨æ ¼å¼
- **M3U Plusæ ¼å¼**ï¼š`/get.php?username=ç”¨æˆ·å&password=å¯†ç &type=m3u_plus`
- åŒ…å«å®Œæ•´çš„é¢‘é“ä¿¡æ¯å’Œåˆ†ç±»
- æ”¯æŒEPGç”µå­èŠ‚ç›®æŒ‡å—

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### è®¿é—®æ§åˆ¶
- ç¾¤ç»„æˆå‘˜èº«ä»½éªŒè¯
- ä¸´æ—¶ä»¤ç‰ŒéªŒè¯æœºåˆ¶
- è‡ªåŠ¨è¿‡æœŸä¿æŠ¤
- User-Agent éªŒè¯ï¼ˆå¯é€‰ï¼‰

### ä½¿ç”¨é™åˆ¶
- æ¯ç”¨æˆ·æ¯æ—¥æœ€å¤šç”Ÿæˆ2ä¸ªä»¤ç‰Œ
- æ¯å°æ—¶æœ€å¤šåˆ·æ–°10æ¬¡æ’­æ”¾åˆ—è¡¨
- æœ€å¤š3ä¸ªè®¾å¤‡åŒæ—¶æ’­æ”¾

### ç›‘æ§åŠŸèƒ½
- å®æ—¶ç›‘æ§ç”¨æˆ·æ´»åŠ¨
- è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®
- è¯¦ç»†çš„è®¿é—®æ—¥å¿—

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### ç³»ç»ŸçŠ¶æ€
- æœåŠ¡å™¨è¿è¡Œæ—¶é—´
- å†…å­˜ä½¿ç”¨æƒ…å†µ
- æ´»è·ƒç”¨æˆ·ç»Ÿè®¡
- é¢‘é“æ•°é‡ç»Ÿè®¡

### æ—¥å¿—è®°å½•
- ç”¨æˆ·è®¤è¯æ—¥å¿—
- è®¿é—®è¯·æ±‚æ—¥å¿—
- é”™è¯¯å’Œå¼‚å¸¸æ—¥å¿—
- ç³»ç»Ÿæ“ä½œæ—¥å¿—

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœºå™¨äººæ— å“åº”
- æ£€æŸ¥bot tokenæ˜¯å¦æ­£ç¡®
- ç¡®è®¤æœºå™¨äººå·²å¯åŠ¨
- æŸ¥çœ‹ç½‘ç»œè¿æ¥çŠ¶æ€

#### 2. æƒé™éªŒè¯å¤±è´¥
- ç¡®è®¤ç”¨æˆ·åœ¨æŒ‡å®šç¾¤ç»„ä¸­
- æ£€æŸ¥ç¾¤ç»„IDé…ç½®
- éªŒè¯ç®¡ç†å‘˜æƒé™

#### 3. æ’­æ”¾åˆ—è¡¨æ— æ³•åŠ è½½
- æ£€æŸ¥M3Ué“¾æ¥æœ‰æ•ˆæ€§
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

#### 4. é“¾æ¥è¿‡æœŸé—®é¢˜
- ä½¿ç”¨ `/gettoken` é‡æ–°è·å–
- æ£€æŸ¥ç³»ç»Ÿæ—¶é—´è®¾ç½®
- ç¡®è®¤é…ç½®æ–‡ä»¶æ­£ç¡®

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log
```

## ğŸš€ éƒ¨ç½²å»ºè®®

### ç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨PM2è¿›ç¨‹ç®¡ç†å™¨
- é…ç½®åå‘ä»£ç†ï¼ˆNginxï¼‰
- å¯ç”¨HTTPSåŠ å¯†
- å®šæœŸå¤‡ä»½é…ç½®å’Œæ•°æ®

### Dockeréƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t xtream-proxy .

# è¿è¡Œå®¹å™¨
docker run -d -p 8080:8080 -v ./config.json:/app/config.json xtream-proxy
```

### ä½¿ç”¨Docker Compose
```bash
docker-compose up -d
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### æœ€æ–°ç‰ˆæœ¬ç‰¹æ€§
- âœ… ç¾¤ç»„æƒé™ä¸¥æ ¼æ§åˆ¶
- âœ… 24å°æ—¶é“¾æ¥è‡ªåŠ¨è¿‡æœŸ
- âœ… è‡ªåŠ¨è¿‡æœŸæé†’æ¨é€
- âœ… æ— éœ€IPéªŒè¯çš„é“¾æ¥ç”Ÿæˆ
- âœ… å®Œæ•´çš„ä¸­æ–‡ç•Œé¢æ”¯æŒ
- âœ… **KODIPROP/EXTVLCOPT æŒ‡ä»¤æ”¯æŒ** - å®Œæ•´æ”¯æŒ DRM å†…å®¹å’Œé«˜çº§æµé…ç½®

### KODIPROP åŠŸèƒ½
æœ¬é¡¹ç›®ç°åœ¨å®Œå…¨æ”¯æŒåŒ…å« `#KODIPROP` å’Œ `#EXTVLCOPT` æŒ‡ä»¤çš„ M3U æ’­æ”¾åˆ—è¡¨ï¼š
- è‡ªåŠ¨è¯†åˆ«å¹¶ä¿ç•™æ‰€æœ‰ KODIPROP æŒ‡ä»¤
- æ”¯æŒ MPEG-DASHã€DRM clearkey ç­‰é«˜çº§æµé…ç½®
- å…¼å®¹ Kodiã€TiviMateã€Perfect Player ç­‰æ’­æ”¾å™¨
- å®Œå…¨é€æ˜å¤„ç†ï¼Œæ— éœ€é¢å¤–é…ç½®

**ç¤ºä¾‹æ”¯æŒçš„è®¢é˜…æ ¼å¼ï¼š**
```m3u
#EXTINF:-1 tvg-id="MytvSuper" tvg-name="SUPERè¯†é£Ÿ",SUPERè­˜é£Ÿ
#KODIPROP:inputstream.adaptive.manifest_type=mpd
#KODIPROP:inputstream.adaptive.license_type=clearkey
#KODIPROP:inputstream.adaptive.license_key=2370118ce3d6fafe17502b0176abf9ae:357c7b5a9d01c25d8e30e46cc396de08
https://example.com/stream.mpd
```

è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒï¼š[KODIPROP æ”¯æŒè¯´æ˜](doc/KODIPROP_SUPPORT.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›é¡¹ç›®ã€‚

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd xtream-proxy

# å®‰è£…ä¾èµ–
npm install

# å¼€å‘æ¨¡å¼è¿è¡Œ
npm run dev
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§LICENSEæ–‡ä»¶ã€‚

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š
1. æŸ¥çœ‹æ•…éšœæ’é™¤éƒ¨åˆ†
2. æäº¤GitHub Issue
3. è”ç³»é¡¹ç›®ç»´æŠ¤è€…

## ğŸ” User-Agent éªŒè¯åŠŸèƒ½

### åŠŸèƒ½æ¦‚è¿°
User-Agent éªŒè¯åŠŸèƒ½å…è®¸ç®¡ç†å‘˜ä¸ºä¸åŒçš„æœåŠ¡å™¨è®¾ç½®ç‰¹å®šçš„ User-Agent è¦æ±‚ï¼Œç”¨æˆ·å¿…é¡»ä½¿ç”¨æŒ‡å®šçš„ User-Agent æ‰èƒ½è§‚çœ‹ç›´æ’­æºè§†é¢‘ã€‚è¿™æä¾›äº†é¢å¤–çš„å®‰å…¨å±‚ï¼Œå¯ä»¥é˜²æ­¢æœªæˆæƒçš„è®¿é—®ã€‚

### ä½¿ç”¨åœºæ™¯
- **æ’­æ”¾å™¨æ§åˆ¶**ï¼šé™åˆ¶åªæœ‰ç‰¹å®šæ’­æ”¾å™¨æ‰èƒ½è®¿é—®
- **è®¿é—®æ§åˆ¶**ï¼šé˜²æ­¢æœªæˆæƒçš„å®¢æˆ·ç«¯è®¿é—®
- **æœåŠ¡å™¨ä¿æŠ¤**ï¼šä¸ºä¸åŒçš„ä¸Šæ¸¸æœåŠ¡å™¨è®¾ç½®ä¸åŒçš„è®¿é—®è¦æ±‚

### é…ç½®ç¤ºä¾‹

#### å¯ç”¨ User-Agent éªŒè¯
```bash
# å¯ç”¨éªŒè¯åŠŸèƒ½
/admin useragent enable

# è®¾ç½®é»˜è®¤ User-Agent
/admin useragent default judy/8.8.8

# è®¾ç½®å›é€€è§†é¢‘URLï¼ˆéªŒè¯å¤±è´¥æ—¶æ’­æ”¾ï¼‰
/admin useragent fallback https://smart.pendy.dpdns.org/judy/output.m3u8

# ä¸ºç‰¹å®šæœåŠ¡å™¨è®¾ç½® User-Agent
/admin useragent set example.com judy/8.8.8
/admin useragent set tv.server.com myplayer/1.0.0
```

#### ç®¡ç† User-Agent è®¾ç½®
```bash
# æŸ¥çœ‹æ‰€æœ‰é…ç½®
/admin useragent list

# ç§»é™¤æœåŠ¡å™¨é…ç½®
/admin useragent remove example.com

# ä¸´æ—¶ç¦ç”¨éªŒè¯
/admin useragent disable
```

### æ’­æ”¾å™¨é…ç½®
ä¸åŒæ’­æ”¾å™¨è®¾ç½®è‡ªå®šä¹‰ User-Agent çš„æ–¹æ³•ï¼š

#### IPTV Smarters Pro
1. è¿›å…¥è®¾ç½® â†’ æ’­æ”¾å™¨è®¾ç½®
2. æ‰¾åˆ° "User-Agent" é€‰é¡¹
3. è¾“å…¥ç®¡ç†å‘˜æä¾›çš„ User-Agent

#### TiviMate
1. è®¾ç½® â†’ æ’­æ”¾å™¨ â†’ ç½‘ç»œ
2. è‡ªå®šä¹‰ User-Agent
3. è¾“å…¥æŒ‡å®šçš„ User-Agent

#### VLC Player
1. å·¥å…· â†’ é¦–é€‰é¡¹ â†’ è¾“å…¥/ç¼–è§£ç å™¨
2. ç½‘ç»œè®¾ç½® â†’ HTTP User-Agent
3. è¾“å…¥è‡ªå®šä¹‰ User-Agent

### æ³¨æ„äº‹é¡¹
- User-Agent éªŒè¯æ˜¯å¤§å°å†™æ•æ„Ÿçš„
- ç¡®ä¿æ’­æ”¾å™¨æ”¯æŒè‡ªå®šä¹‰ User-Agent è®¾ç½®
- è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„è®¿é—®æ§åˆ¶å±‚ï¼Œå¯ä»¥è¢«æŠ€æœ¯ç”¨æˆ·ç»•è¿‡
- å»ºè®®ä¸å…¶ä»–å®‰å…¨æªæ–½ç»“åˆä½¿ç”¨

### è¯¦ç»†æ–‡æ¡£
æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ [User-Agent åŠŸèƒ½è¯´æ˜](doc/USER_AGENT_FEATURE.md)

---

**æ³¨æ„**ï¼šè¯·ç¡®ä¿éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œåˆç†ä½¿ç”¨IPTVæœåŠ¡ã€‚ 